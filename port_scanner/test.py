import port_scanner


def main():
    ports = [21, 22, 80]
    host = "172.25.231.106"

    try:
        print("Nmap scan will start, please wait!")
        nmap_scan = port_scanner.Nmap(host, ports)
        os_info = nmap_scan.get_os()
        if os_info:
            for os_estimation in os_info:
                print(
                    f"OS Estimation: {os_estimation['name']} (Accuracy: {os_estimation['accuracy']}%)"
                )
                if "type" in os_estimation:
                    print(
                        f"  Type: {os_estimation['type']}, Vendor: {os_estimation['vendor']}, OS Family: {os_estimation['osfamily']}, OS Generation: {os_estimation['osgen']}"
                    )
        else:
            print("OS detection not available")

        print()
        for port in ports:
            service_info = nmap_scan.get_service_version(port)
            if service_info:
                print(
                    f"Service Information for port {port}: {service_info.get('service')}, Version: {service_info.get('version')}"
                )
            else:
                print(f"No service version information available for port {port}")

            cves = nmap_scan.get_cves(port)
            if cves:
                print(f"CVEs for port {port}:")
                for cve in cves:
                    print(f"  {cve['id']}")
                    if cve["url"]:
                        print(f"    URL: {cve['url']}")
            else:
                print(f"No CVEs found for port {port}.")
            print()

    except port_scanner.PortScannerError as error:
        print(error)


if __name__ == "__main__":
    main()
